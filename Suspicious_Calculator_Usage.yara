rule Suspicious_Calculator_Usage {
    meta:
        description = "Detects suspicious use of 'calc.exe' with command line parameters or in a suspicious directory"
        author = "Florian Roth (Nextron Systems)"
        date = "2019/02/09"
        reference = "https://twitter.com/ItsReallyNick/status/1094080242686312448"
    strings:
        $calc_command_line = /\calc\.exe /
        $calc_executable = /\\calc\.exe$/
    condition:
        $calc_command_line or ($calc_executable and not ( /\\Windows\\System32\\/ or /\\Windows\\SysWOW64\\/ or /\\Windows\\WinSxS\\/ ))
}
