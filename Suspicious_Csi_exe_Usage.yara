rule Suspicious_Csi_exe_Usage {
    meta:
        description = "Detects suspicious usage of Csi.exe, a signed binary from Microsoft that comes with Visual Studio."
        author = "Konstantin Grishchenko, oscd.community"
        date = "2020/10/17"
        modified = "2022/07/11"
        status = "test"
        tags = "attack.execution, attack.t1072, attack.defense_evasion, attack.t1218, level.medium"
    strings:
        $csi_exe_str = "csi.exe" wide
        $rcsi_exe_str = "rcsi.exe" wide
        $microsoft_corporation_str = "Microsoft Corporation" wide
    condition:
        (
            (
                any of ($csi_exe_str, $rcsi_exe_str) at (uint32(@csi_exe_str) - 4) and
                $microsoft_corporation_str at (uint32(@microsoft_corporation_str) - 4)
            )
        )
}
