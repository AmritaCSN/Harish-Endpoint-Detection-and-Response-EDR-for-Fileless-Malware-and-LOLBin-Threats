rule Read_Contents_From_Stdin_Via_Cmd_EXE {
    meta:
        description = "Detects the use of '<' to read and potentially execute a file via cmd.exe"
        author = "frack113, Nasreddine Bencherchali (Nextron Systems)"
        date = "2023/03/07"
        status = "test"
        tags = "attack.execution, attack.t1059.003, level.medium"
    strings:
        $cmd_exe_path = "cmd.exe" wide
        $stdin_redirection = "<" wide
    condition:
        $cmd_exe_path at 0 and
        $stdin_redirection at 1
}
