rule Potential_DLL_Sideloading_DeviceEnroller {
    meta:
        description = "Detects the use of the PhoneDeepLink parameter to potentially sideload a DLL file that does not exist via DeviceEnroller.exe."
        author = "@gott_cyber"
        date = "2022/08/29"
        modified = "2023/02/04"
        status = "test"
        tags = "attack.defense_evasion, attack.t1574.002, level.medium"
    strings:
        $deviceenroller_exe = "deviceenroller.exe" wide
        $phone_deep_link = "/PhoneDeepLink" wide
    condition:
        all of them
}
