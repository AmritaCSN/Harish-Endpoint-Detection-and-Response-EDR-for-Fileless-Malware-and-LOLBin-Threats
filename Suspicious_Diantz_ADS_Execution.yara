rule Suspicious_Diantz_ADS_Execution {
    meta:
        description = "Compress target file into a cab file stored in the Alternate Data Stream (ADS) of the target file."
        author = "frack113"
        date = "2021/11/26"
        modified = "2022/12/31"
        status = "test"
        tags = "attack.defense_evasion, attack.t1564.004"
        references = "https://lolbas-project.github.io/lolbas/Binaries/Diantz/"
    strings:
        $diantz_exe = "diantz.exe" nocase wide
        $cab_extension = ".cab" wide
        $ads_separator = ":[^\\]" wide
    condition:
        $diantz_exe at 0 and
        $cab_extension at 2 and
        $ads_separator
}
