rule PowerShellGetProcessLSASS {
    meta:
        description = "Detects a 'Get-Process' cmdlet and its aliases on lsass process, which is in almost all cases a sign of malicious activity."
        author = "Florian Roth (Nextron Systems)"
        date = "2021/04/23"
        modified = "2023/01/05"
        reference = "https://twitter.com/PythonResponder/status/1385064506049630211"
        tags = "attack.credential_access, attack.t1552.004"
    strings:
        $cmd1 = "Get-Process lsas"
        $cmd2 = "ps lsas"
        $cmd3 = "gps lsas"
    condition:
        any of them
}
