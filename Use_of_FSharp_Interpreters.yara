rule Use_of_FSharp_Interpreters {
    meta:
        description = "Detects the use of FSharp Interpreters for AWL bypass"
        author = "Christopher Peacock @SecurePeacock, SCYTHE @scythe_io"
        date = "2022/06/02"
        status = "test"
        tags = "attack.execution, attack.t1059"
        references = "https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules, https://bohops.com/2020/11/02/exploring-the-wdac-microsoft-recommended-block-rules-part-ii-wfc-fsi/, https://lolbas-project.github.io/lolbas/OtherMSBinaries/FsiAnyCpu/, https://lolbas-project.github.io/lolbas/OtherMSBinaries/Fsi/"
    strings:
        $fsianycpu_exe = "fsianycpu.exe" wide ascii
        $fsi_exe = "fsi.exe" wide ascii
    condition:
        any of them
}
