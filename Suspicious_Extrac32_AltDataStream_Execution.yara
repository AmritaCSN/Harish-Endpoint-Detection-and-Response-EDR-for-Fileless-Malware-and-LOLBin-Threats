rule Suspicious_Extrac32_AltDataStream_Execution {
    meta:
        description = "Detects suspicious Extrac32.exe execution with alternate data stream"
        author = "frack113"
        date = "2022/12/30"
        status = "test"
        tags = "attack.defense_evasion, attack.t1564.004"
        references = "https://lolbas-project.github.io/lolbas/Binaries/Extrac32/"
    strings:
        $extrac32_cab = "extrac32.exe" nocase wide ascii
        $cab_extension = ".cab" nocase wide ascii
        $alt_data_stream = ":\\[^\\]+" wide
    condition:
        all of ($extrac32_cab, $cab_extension, $alt_data_stream)
}
