rule VMware_Xfer_DLL_Sideloading {
    meta:
        description = "Detects execution of VMware Xfer utility (VMwareXferlogs.exe) from a non-default directory which may be an attempt to sideload arbitrary DLL."
        author = "Nasreddine Bencherchali (Nextron Systems)"
        date = "2022/08/02"
        status = "test"
        tags = "attack.defense_evasion, attack.t1574.002, level.high"
    strings:
        $vmware_xfer_exe = "VMwareXferlogs.exe" wide
        $vmware_path = "C:\\Program Files\\VMware\\" wide
    condition:
        (uint16(0) == 0x5A4D) and
        ($vmware_xfer_exe at 0) and
        (not $vmware_path)
}
