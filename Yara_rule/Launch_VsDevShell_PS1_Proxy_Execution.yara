rule Launch_VsDevShell_PS1_Proxy_Execution {
    meta:
        description = "Detects the use of the 'Launch-VsDevShell.ps1' Microsoft signed script to execute commands"
        author = "Nasreddine Bencherchali (Nextron Systems)"
        date = "2022/08/19"
        status = "test"
        tags = "attack.defense_evasion, attack.t1216.001"
        references = "https://twitter.com/nas_bench/status/1535981653239255040"
    strings:
        $launch_vsdevshell_ps1 = "Launch-VsDevShell.ps1" wide ascii
        $vswhere_path = "VsWherePath " wide ascii
        $vsinstallation_path = "VsInstallationPath " wide ascii
    condition:
        $launch_vsdevshell_ps1 at 0 and ($vswhere_path and $vsinstallation_path)
}
