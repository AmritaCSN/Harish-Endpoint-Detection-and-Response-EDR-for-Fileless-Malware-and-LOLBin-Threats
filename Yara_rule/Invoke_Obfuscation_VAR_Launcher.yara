rule Invoke_Obfuscation_VAR_Launcher {
    meta:
        description = "Detects Obfuscated use of Environment Variables to execute PowerShell"
        author = "Jonathan Cheong, oscd.community"
        date = "2020/10/15"
        modified = "2022/11/17"
        status = "test"
        tags = "attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001"
        references = "https://github.com/SigmaHQ/sigma/issues/1009"
    strings:
        $var_launcher_1 = /cmd.*\/[cr].*set [a-zA-Z]{3,6}.*\{\d\}.*\-f.*\)/
    condition:
        any of them
}
