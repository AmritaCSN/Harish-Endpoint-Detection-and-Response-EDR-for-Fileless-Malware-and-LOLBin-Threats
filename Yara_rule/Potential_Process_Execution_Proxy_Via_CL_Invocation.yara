rule Potential_Process_Execution_Proxy_Via_CL_Invocation {
    meta:
        description = "Detects calls to 'SyncInvoke' in CL_Invocation.ps1 script to proxy execution using System.Diagnostics.Process"
        author = "Nasreddine Bencherchali (Nextron Systems), oscd.community, Natalia Shornikova"
        date = "2020/10/14"
        reference = "https://lolbas-project.github.io/lolbas/Scripts/Cl_invocation/"
        level = "medium"

    strings:
        $sync_invoke_pattern = /SyncInvoke\s/

    condition:
        uint16(0) == 0x5A4D and $sync_invoke_pattern
}
