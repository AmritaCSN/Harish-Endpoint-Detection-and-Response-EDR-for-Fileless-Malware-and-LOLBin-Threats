rule VolumeShadowCopy_Symlink_Creation_Via_Mklink {
    meta:
        description = "Shadow Copies storage symbolic link creation using operating systems utilities"
        author = "Teymur Kheirkhabarov, oscd.community"
        date = "2019/10/22"
        modified = "2023/03/06"
        reference = "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment"
        status = "stable"
        tags = "attack.credential_access, attack.t1003.002, attack.t1003.003, level.high"
    strings:
        $mklink_pattern = "mklink" wide
        $shadowcopy_pattern = "HarddiskVolumeShadowCopy" wide
    condition:
        all of ($mklink_pattern, $shadowcopy_pattern)
}
