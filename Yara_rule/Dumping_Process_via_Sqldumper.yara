rule Dumping_Process_via_Sqldumper {
    meta:
        description = "Detects process dump via legitimate sqldumper.exe binary"
        reference = "https://twitter.com/countuponsec/status/910977826853068800"
        author = "Kirill Kiryanov, oscd.community"
        date = "2020/10/08"
        level = "medium"
    strings:
        $sqldumper = "sqldumper.exe" nocase
    condition:
        $sqldumper at 0 and
        // Check if sqldumper.exe command line contains the specified parameters
        (uint8(32) == 0x30 and uint8(33) == 0x78 and uint8(34) == 0x30 and uint8(35) == 0x31 and
         uint8(36) == 0x31 and uint8(37) == 0x30) or
        (uint8(33) == 0x30 and uint8(34) == 0x78 and uint8(35) == 0x30 and uint8(36) == 0x31 and
         uint8(37) == 0x30 and uint8(38) == 0x3A and uint8(39) == 0x34 and uint8(40) == 0x30)
}
