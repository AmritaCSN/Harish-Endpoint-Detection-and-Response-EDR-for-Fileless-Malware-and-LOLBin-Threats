rule GzipArchiveDecodePowerShell {
    meta:
        description = "Detects attempts of decoding encoded Gzip archives via PowerShell"
        author = "Hieu Tran"
        date = "2023/03/13"
        reference = "https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution"
        tags = "attack.command_and_control, attack.t1132.001"
    strings:
        $cmdline = "GZipStream" wide ascii nocase
        $method = "::Decompress" wide ascii nocase
    condition:
        $cmdline at 0 and $method at 0
}
