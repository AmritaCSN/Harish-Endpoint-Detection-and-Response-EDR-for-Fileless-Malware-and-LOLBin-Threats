rule Ilasm_Lolbin_Use_Compile_CSharp {
    meta:
        description = "Detect use of Ilasm.exe to compile C# code into DLL or EXE"
        author = "frack113"
        date = "2022/05/07"
        modified = "2022/05/16"
        status = "test"
        tags = "attack.defense_evasion, attack.t1127"
        references = "https://lolbas-project.github.io/lolbas/Binaries/Ilasm/, https://www.echotrail.io/insights/search/ilasm.exe"
    strings:
        $ilasm_exe = "ilasm.exe" wide ascii
    condition:
        all of them
        and $ilasm_exe at (uint16(0))
}
