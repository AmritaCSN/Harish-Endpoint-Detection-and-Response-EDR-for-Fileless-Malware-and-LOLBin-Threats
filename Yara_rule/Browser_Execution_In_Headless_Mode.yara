rule Browser_Execution_In_Headless_Mode {
    meta:
        description = "Detects execution of Chromium-based browser in headless mode"
        author = "Nasreddine Bencherchali"
        date = "2023-09-12"
        reference = "https://twitter.com/mrd0x/status/1478234484881436672?s=12, https://www.trendmicro.com/en_us/research/23/e/managed-xdr-investigation-of-ducktail-in-trend-micro-vision-one.html"
    strings:
        $browser_executables = /\\(brave|chrome|msedge|opera|vivaldi)\.exe$/
        $headless_parameter = "--headless"
    condition:
        $browser_executables at 0 and $headless_parameter at 0
}
