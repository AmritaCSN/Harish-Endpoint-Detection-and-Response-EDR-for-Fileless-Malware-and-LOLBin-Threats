rule Suspicious_Dump64_Execution {
    meta:
        description = "Detects suspicious dump64.exe execution"
        author = "Austin Songer, Florian Roth"
        date = "2023/03/24"
        status = "test"
        tags = "attack.credential_access, attack.t1003.001"
        references = "https://twitter.com/mrd0x/status/1460597833917251595"
    strings:
        $dump64_exe = "dump64.exe" nocase wide
        $procdump_flags_1 = " -ma " wide
        $procdump_flags_2 = "accepteula" wide
        $excluded_folder = "\\Installer\\Feedback\\dump64.exe" wide
    condition:
        ( $dump64_exe at 0 and ( $excluded_folder at 0 and not ( $procdump_flags_1 at 0 and $procdump_flags_2 at 0 ) ) ) or ( $dump64_exe at 0 and $procdump_flags_1 at 0 and $procdump_flags_2 at 0 )
}
