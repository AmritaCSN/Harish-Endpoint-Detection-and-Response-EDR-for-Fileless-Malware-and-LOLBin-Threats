rule Microsoft_IIS_Connection_Strings_Decryption {
    meta:
        description = "Detects use of aspnet_regiis to decrypt Microsoft IIS connection strings"
        author = "Tim Rauch, Elastic (idea)"
        date = "2022/09/28"
        status = "test"
        tags = "attack.credential_access, attack.t1003"
        references = "https://www.elastic.co/guide/en/security/current/microsoft-iis-connection-strings-decryption.html"
    strings:
        $aspnet_regiis_cmdline = /.*aspnet_regiis\.exe.*connectionStrings.*-pdf.*/ nocase
    condition:
        all of them
}
