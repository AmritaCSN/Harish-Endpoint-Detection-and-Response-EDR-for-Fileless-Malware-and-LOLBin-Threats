rule Change_Default_File_Association_Via_Assoc {
    meta:
        description = "Detects file association changes using the builtin assoc command."
        author = "Timur Zinniatullin, oscd.community"
        date = "2019/10/21"
        modified = "2023/03/06"
        reference = "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.001/T1546.001.md"
        status = "test"
        tags = "attack.persistence, attack.t1546.001, level.low"
    strings:
        $assocCmd = "assoc"
        $cmdExe = "\\cmd.exe"
    condition:
        $assocCmd at (uint16(0)) and
        any of ($cmdExe*)
}
