rule Arbitrary_MSI_Download_Devinit {
    meta:
        description = "Detects a certain command line flag combination used by Devinit.exe, which can be abused as a LOLBIN to download arbitrary MSI packages on a Windows system."
        author = "Florian Roth (Nextron Systems)"
        date = "2022/01/11"
        modified = "2023/04/06"
        status = "test"
        tags = "attack.execution, attack.defense_evasion, attack.t1218, level.medium"
    strings:
        $devinit_exe = "devinit.exe" wide
        $msi_install = " -t msi-install " wide
        $http_flag = " -i http" wide
    condition:
        all of them
}
