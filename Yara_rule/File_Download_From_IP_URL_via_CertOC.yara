rule File_Download_From_IP_URL_via_CertOC {
    meta:
        description = "Detects file download from an IP-based URL using CertOC.exe"
        author = "Nasreddine Bencherchali (Nextron Systems)"
        date = "2023/10/18"
    strings:
        $certoc_executable = /\\CertOC\.exe$/i
        $ip_based_url = /:\/\/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/
        $certoc_getcacaps = /-GetCACAPS/
    condition:
        $certoc_executable and $ip_based_url and $certoc_getcacaps
}
