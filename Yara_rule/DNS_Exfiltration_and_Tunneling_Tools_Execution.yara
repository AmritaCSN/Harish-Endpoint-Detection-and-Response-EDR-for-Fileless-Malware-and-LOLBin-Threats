rule DNS_Exfiltration_and_Tunneling_Tools_Execution {
    meta:
        description = "Detects the execution of well-known DNS exfiltration and tunneling tools."
        author = "Daniil Yugoslavskiy, oscd.community"
        date = "2019/10/24"
        modified = "2021/11/27"
        status = "test"
        tags = "attack.exfiltration, attack.t1048.001, attack.command_and_control, attack.t1071.004, attack.t1132.001, level.high"
    strings:
        $iodine_exe = "iodine.exe" wide
        $dnscat2_string1 = "\\dnscat2" wide
        $dnscat2_string2 = "/dnscat2" wide
    condition:
        (uint16(0) == 0x5A4D) and
        ($iodine_exe at 0 or ($dnscat2_string1 and $dnscat2_string2))
}
