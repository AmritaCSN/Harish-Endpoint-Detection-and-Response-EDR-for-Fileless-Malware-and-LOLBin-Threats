rule Explorer_Process_Tree_Break {
    meta:
        description = "Detects a command line process that uses explorer.exe to launch arbitrary commands or binaries, breaking the process tree"
        author = "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems), @gott_cyber"
        date = "2019/06/29"
        modified = "2022/09/20"
        status = "test"
        tags = "attack.defense_evasion, attack.t1036, level.medium"
    strings:
        $factory_clsid = "/factory,{75dff2b7-6936-4c06-a8bb-676a7b00b24b}" wide
        $root_flag = " /root," wide
    condition:
        any of them
}
