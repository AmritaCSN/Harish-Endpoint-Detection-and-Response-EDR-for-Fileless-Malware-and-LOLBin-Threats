rule Binary_Proxy_Execution_Via_Dotnet_Trace_EXE {
    meta:
        description = "Detects command line arguments for executing a child process via dotnet-trace.exe"
        author = "Jimmy Bayne (@bohops)"
        date = "2024/01/02"
        status = "experimental"
        tags = "attack.execution, attack.defense_evasion, attack.t1218, level.medium"
    strings:
        $dotnet_trace_exe = "dotnet-trace.exe" wide
        $dotnet_trace_dll = "dotnet-trace.dll" wide
        $collect_arg = "-- collect" wide
    condition:
        (uint16(0) == 0x5A4D) and
        ($dotnet_trace_exe at 0) and
        ($dotnet_trace_dll at 0) and
        all of ($collect_arg)
}
