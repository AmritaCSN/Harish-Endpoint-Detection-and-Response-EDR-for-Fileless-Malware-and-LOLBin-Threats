rule Gpscript_Execution {
    meta:
        description = "Detects the execution of the LOLBIN gpscript"
        author = "frack113"
        date = "2022/05/16"
        modified = "2023/06/14"
        status = "experimental"
        tags = "attack.defense_evasion, attack.t1218"
        references = "https://oddvar.moe/2018/04/27/gpscript-exe-another-lolbin-to-the-list/, https://lolbas-project.github.io/lolbas/Binaries/Gpscript/"
    strings:
        $gpscript_exe = "gpscript.exe" wide ascii
        $logon_flag = " /logon" wide ascii
        $startup_flag = " /startup" wide ascii
    condition:
        (any of ($gpscript_exe, $logon_flag, $startup_flag) at (uint16(0)))
}
