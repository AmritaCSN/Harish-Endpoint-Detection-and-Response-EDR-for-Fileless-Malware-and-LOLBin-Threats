rule Suspicious_Extrac32_Execution {
    meta:
        description = "Detects suspicious Extrac32.exe execution for file download or copy"
        author = "frack113"
        date = "2022/08/13"
        status = "test"
        tags = "attack.command_and_control, attack.t1105"
        references = "https://lolbas-project.github.io/lolbas/Binaries/Extrac32/"
    strings:
        $extrac32_cmdline = "extrac32.exe" nocase wide ascii
        $cab_extension = ".cab" nocase wide ascii
        $extrac32_options = "/C" wide ascii
        $extrac32_options2 = "/Y" wide ascii
        $extrac32_options3 = " \\\\" wide ascii
    condition:
        all of ($extrac32_cmdline, $cab_extension, $extrac32_options, $extrac32_options2, $extrac32_options3)
}
