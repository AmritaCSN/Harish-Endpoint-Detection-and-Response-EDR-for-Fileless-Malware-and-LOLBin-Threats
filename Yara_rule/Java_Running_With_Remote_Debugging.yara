rule Java_Running_With_Remote_Debugging {
    meta:
        description = "Detects a JAVA process running with remote debugging allowing more than just localhost to connect"
        author = "Florian Roth (Nextron Systems)"
        date = "2019/01/16"
        modified = "2023/02/01"
        status = "test"
        tags = "attack.t1203, attack.execution"
        references = "https://dzone.com/articles/remote-debugging-java-applications-with-jdwp"
    strings:
        $jdwp_transport = "transport=dt_socket,address="
        $old_jvm_version = /j[rd]e1\./
        $exclusion = "address=127.0.0.1" wide ascii nocase
        $exclusion2 = "address=localhost" wide ascii nocase
    condition:
        $jdwp_transport in (uint8(0) .. filesize) and
        $old_jvm_version and
        (not $exclusion or not $exclusion2)
}
