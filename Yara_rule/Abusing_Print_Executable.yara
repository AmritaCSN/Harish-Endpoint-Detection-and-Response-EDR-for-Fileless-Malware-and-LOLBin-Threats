rule Abusing_Print_Executable {
    meta:
        description = "Detects potential abuse of print.exe for remote file copy"
        reference = "https://lolbas-project.github.io/lolbas/Binaries/Print/"
        author = "Furkan CALISKAN, @caliskanfurkan_, @oscd_initiative"
        date = "2020/10/05"
        modified = "2022/07/07"
        tags = "attack.defense_evasion, attack.t1218"

    strings:
        $image_endswith_print = /print\.exe/
        $cmd_startswith_print = /^print/
        $cmd_contains_all_dexe = /\/D.*\.exe/

    condition:
        ( $image_endswith_print or $cmd_startswith_print ) and $cmd_contains_all_dexe
}
