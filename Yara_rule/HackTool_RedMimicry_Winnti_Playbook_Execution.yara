rule HackTool_RedMimicry_Winnti_Playbook_Execution {
    meta:
        description = "Detects actions caused by the RedMimicry Winnti playbook, an automated breach emulations utility."
        author = "Alexander Rausch"
        date = "2020/06/24"
        modified = "2023/03/01"
        status = "test"
        tags = "attack.execution, attack.defense_evasion, attack.t1106, attack.t1059.003, attack.t1218.011"
        references = "https://redmimicry.com/posts/redmimicry-winnti/"
    strings:
        $hacktool_rundll32_exe = /.*\\rundll32\.exe$/
        $hacktool_cmd_exe = /.*\\cmd\.exe$/
        $hacktool_gthread_dll = "gthread-3.6.dll"
        $hacktool_tmp_bat = "\\Windows\\Temp\\tmp.bat"
        $hacktool_sigcmm_dll = "sigcmm-2.4.dll"
    condition:
        ($hacktool_rundll32_exe or $hacktool_cmd_exe) and
        all of ($hacktool_gthread_dll, $hacktool_tmp_bat, $hacktool_sigcmm_dll)
}
