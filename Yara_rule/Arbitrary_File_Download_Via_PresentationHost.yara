rule Arbitrary_File_Download_Via_PresentationHost {
    meta:
        description = "Detects usage of PresentationHost to download arbitrary files"
        author = "Nasreddine Bencherchali (Nextron Systems)"
        date = "2022/08/19"
        modified = "2023/11/09"
        references = "https://github.com/LOLBAS-Project/LOLBAS/pull/239/files"
        tags = "attack.defense_evasion, attack.execution, attack.t1218"
        level = "medium"

    strings:
        $presentationHost = "PresentationHost.exe"
        $downloadProtocols = /http:\/\/|https:\/\/|ftp:\/\//

    condition:
        $presentationHost at 0 and $downloadProtocols
}
