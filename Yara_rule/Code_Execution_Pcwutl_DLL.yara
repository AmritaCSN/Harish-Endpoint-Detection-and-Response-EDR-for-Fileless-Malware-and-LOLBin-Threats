rule Code_Execution_Pcwutl_DLL {
    meta:
        description = "Detects launch of executable by calling the LaunchApplication function from pcwutl.dll library."
        reference = "https://lolbas-project.github.io/lolbas/Libraries/Pcwutl/"
        author = "Julia Fomina, oscd.community"
        date = "2020/10/05"
        modified = "2023/02/09"
        level = "medium"
    strings:
        $img_endswith = "rundll32.exe"
        $orig_filename = "RUNDLL32.EXE"
        $cli_contains_pcwutl = "pcwutl"
        $cli_contains_launchapp = "LaunchApplication"
    condition:
        all of them
}
