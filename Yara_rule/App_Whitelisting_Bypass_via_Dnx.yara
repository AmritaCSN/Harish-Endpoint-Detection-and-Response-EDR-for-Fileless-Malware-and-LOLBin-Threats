rule App_Whitelisting_Bypass_via_Dnx {
    meta:
        description = "Detects execution of C# code located in the consoleapp folder using dnx.exe"
        author = "Beyu Denis, oscd.community"
        date = "2019/10/26"
        modified = "2021/11/27"
        status = "test"
        tags = "attack.defense_evasion, attack.t1218, attack.t1027.004"
        references = "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Csi/; https://enigma0x3.net/2016/11/17/bypassing-application-whitelisting-by-using-dnx-exe/"
    strings:
        $dnx_exe = "dnx.exe" nocase wide
    condition:
        $dnx_exe at 0
}
