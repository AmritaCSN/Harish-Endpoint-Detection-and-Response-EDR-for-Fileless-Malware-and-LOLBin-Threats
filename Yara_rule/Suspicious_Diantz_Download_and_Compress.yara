rule Suspicious_Diantz_Download_and_Compress {
    meta:
        description = "Download and compress a remote file and store it in a cab file on the local machine."
        author = "frack113"
        date = "2021/11/26"
        modified = "2022/08/13"
        status = "test"
        tags = "attack.command_and_control, attack.t1105"
        references = "https://lolbas-project.github.io/lolbas/Binaries/Diantz/"
    strings:
        $diantz_exe = "diantz.exe" nocase wide
        $remote_path_indicator = " \\\\" wide
        $cab_extension = ".cab" wide
    condition:
        $diantz_exe at 0 and
        $remote_path_indicator and
        $cab_extension
}
