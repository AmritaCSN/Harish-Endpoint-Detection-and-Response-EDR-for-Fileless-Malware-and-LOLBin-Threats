rule Invoke_Obfuscation_STDIN_Launcher {
    meta:
        description = "Detects Obfuscated use of stdin to execute PowerShell"
        author = "Jonathan Cheong, oscd.community"
        date = "2020/10/15"
        modified = "2022/11/17"
        status = "test"
        tags = "attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001"
        references = "https://github.com/SigmaHQ/sigma/issues/1009"
    strings:
        $stdin_launcher_1 = /cmd.*\/[cr].*powershell.*\$\{?input\}?|noexit.*"/
        $stdin_launcher_2 = /cmd.*\/[cr].*powershell.*\$\{?input\}?|noexit.*\${executioncontext}.invokecommand.invokescript\( \$input \)/
    condition:
        any of them
}
