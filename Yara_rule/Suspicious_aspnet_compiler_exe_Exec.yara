rule Suspicious_aspnet_compiler_exe_Execution
{
    meta:
        description = "Detects suspicious execution of aspnet_compiler.exe"
        id = "a01b8329-5953-4f73-ae2d-aa01e1f35f00"
        status = "test"
        references = "https://lolbas-project.github.io/lolbas/Binaries/Aspnet_Compiler/"
        author = "frack113"
        date = "2021/11/24"
        modified = "2022/12/25"
        tags = "attack.defense_evasion, attack.t1127"
        level = "medium"

    strings:
        $image_contains_framework = "C:\\Windows\\Microsoft.NET\\Framework" nocase
        $image_contains_aspnet_compiler = "aspnet_compiler.exe" nocase

    condition:
        $image_contains_framework and $image_contains_aspnet_compiler
}
