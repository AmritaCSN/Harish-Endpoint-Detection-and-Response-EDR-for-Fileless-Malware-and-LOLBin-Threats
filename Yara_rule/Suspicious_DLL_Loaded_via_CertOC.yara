rule Suspicious_DLL_Loaded_via_CertOC {
    meta:
        description = "Detects loading of suspicious DLL via CertOC.exe"
        author = "Nasreddine Bencherchali (Nextron Systems)"
        date = "2023/02/15"
    strings:
        $certoc_executable = /\\CertOC\.exe$/i
        $load_dll_in_commandline_1 = / -LoadDLL /i
        $load_dll_in_commandline_2 = / \/LoadDLL /i
        $suspicious_paths = /\Appdata\\Local\\Temp\\|\Desktop\\|\Downloads\\|\\Users\\Public\\|C:\\Windows\\Tasks\\|C:\\Windows\\Temp\\/
    condition:
        $certoc_executable and ($load_dll_in_commandline_1 or $load_dll_in_commandline_2) and $suspicious_paths
}
