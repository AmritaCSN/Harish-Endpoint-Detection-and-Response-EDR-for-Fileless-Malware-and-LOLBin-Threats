rule DeviceCredentialDeployment_Execution {
    meta:
        description = "Detects the execution of DeviceCredentialDeployment to hide a process from view"
        author = "Nasreddine Bencherchali (Nextron Systems)"
        date = "2022/08/19"
        status = "test"
        tags = "attack.defense_evasion, attack.t1218"
        references = "https://github.com/LOLBAS-Project/LOLBAS/pull/147"
    strings:
        $deviceCredentialDeployment_exe = "DeviceCredentialDeployment.exe" wide
    condition:
        $deviceCredentialDeployment_exe at 0 and
        all of them
}
