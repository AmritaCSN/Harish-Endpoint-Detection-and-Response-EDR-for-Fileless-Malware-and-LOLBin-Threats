rule Ie4uinit_Lolbin_Use_From_Invalid_Path {
    meta:
        description = "Detect use of ie4uinit.exe to execute commands from a specially prepared ie4uinit.inf file from a directory other than the usual directories"
        author = "frack113"
        date = "2022/05/07"
        modified = "2022/05/16"
        status = "test"
        tags = "attack.defense_evasion, attack.t1218"
        references = "https://lolbas-project.github.io/lolbas/Binaries/Ie4uinit/, https://bohops.com/2018/03/10/leveraging-inf-sct-fetch-execute-techniques-for-bypass-evasion-persistence-part-2/"
    strings:
        $ie4uinit_exe = "ie4uinit.exe" wide ascii
    condition:
        all of them
        and $ie4uinit_exe at (uint16(0))
}
