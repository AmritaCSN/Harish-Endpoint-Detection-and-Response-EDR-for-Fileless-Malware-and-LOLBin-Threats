rule Suspicious_Execution_of_InstallUtil_Without_Log {
    meta:
        description = "Uses the .NET InstallUtil.exe application in order to execute image without log"
        author = "frack113"
        date = "2022/01/23"
        modified = "2022/02/04"
        status = "test"
        tags = "attack.defense_evasion"
        references = "https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/, https://docs.microsoft.com/en-us/dotnet/framework/tools/installutil-exe-installer-tool"
    strings:
        $installutil_exe = /\\InstallUtil\.exe/i
        $framework_path = /Microsoft\.NET\\Framework/i
        $logfile = /\/logfile=/i
        $logtoconsole = /\/LogToConsole=false/i
    condition:
        all of ($installutil_exe, $framework_path, $logfile, $logtoconsole)
}
