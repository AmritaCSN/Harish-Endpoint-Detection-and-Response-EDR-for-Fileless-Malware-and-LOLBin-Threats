rule Potential_DLL_Injection_Execution_Using_Tracker {
    meta:
        description = "Detects potential DLL injection and execution using Tracker.exe"
        reference = "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Tracker/"
        author = "Avneet Singh @v3t0_, oscd.community"
        date = "2020/10/18"
        modified = "2023/01/09"
        level = "medium"
    strings:
        $trackerExe = "Tracker.exe" nocase
        $dllInjectionArgs1 = " /d " nocase
        $dllInjectionArgs2 = " /c " nocase
        $msbuildErrorReportPrompt = " /ERRORREPORT:PROMPT " nocase
        $msbuildParentImage1 = "Msbuild\\Current\\Bin\\MSBuild.exe" nocase
        $msbuildParentImage2 = "Msbuild\\Current\\Bin\\amd64\\MSBuild.exe" nocase
        $msbuildTrackerArgs = /"Tracker.exe" @".*\\tmp[0-9a-f]+\.tmp" \/c/ nocase
    condition:
        $trackerExe at 0 and
        ($dllInjectionArgs1 or $dllInjectionArgs2) and
        not $msbuildErrorReportPrompt and
        ($msbuildParentImage1 or $msbuildParentImage2) and
        $msbuildTrackerArgs
}
