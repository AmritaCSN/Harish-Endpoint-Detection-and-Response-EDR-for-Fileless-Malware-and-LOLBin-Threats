rule Potential_Recon_Activity_GatherNetworkInfo_VBS {
    meta:
        description = "Detects execution of gatherNetworkInfo.vbs script"
        author = "blueteamer8699"
        date = "2022/01/03"
        modified = "2023/02/08"
        status = "test"
        tags = "attack.discovery, attack.execution, attack.t1615, attack.t1059.005"
        references = "https://posts.slayerlabs.com/living-off-the-land/#gathernetworkinfovbs, https://www.mandiant.com/resources/blog/trojanized-windows-installers-ukrainian-government"
    strings:
        $cscript_exe = "cscript.exe" wide ascii
        $wscript_exe = "wscript.exe" wide ascii
        $gatherNetworkInfo_vbs = "gatherNetworkInfo.vbs" wide ascii
    condition:
        (any of ($cscript_exe, $wscript_exe) at (uint16(0)) and $gatherNetworkInfo_vbs at (uint16(0)))
}
