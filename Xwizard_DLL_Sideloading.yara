rule Xwizard_DLL_Sideloading {
    meta:
        description = "Detects the execution of Xwizard tool from a non-default directory which can be used to sideload a custom xwizards.dll"
        author = "Christian Burkard (Nextron Systems)"
        date = "2021/09/20"
        modified = "2022/10/09"
        status = "test"
        tags = "attack.defense_evasion, attack.t1574.002"
        references = "https://lolbas-project.github.io/lolbas/Binaries/Xwizard/; http://www.hexacorn.com/blog/2017/07/31/the-wizard-of-x-oppa-plugx-style/"
    strings:
        $xwizard_exe = "xwizard.exe" nocase wide
        $system32_path = "C:\\Windows\\System32\\" wide
    condition:
        $xwizard_exe at 0 and
        not $system32_path
}
